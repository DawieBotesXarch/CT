Refactor $ARGUMENTS to improve code quality while maintaining functionality.

1. Read and understand the current implementation
2. Identify code smells and improvement opportunities:
   - Duplicated code
   - Long functions/methods
   - Poor naming
   - Complex conditional logic
   - Tight coupling
3. Plan the refactoring approach
4. Make incremental improvements
5. Ensure tests pass after each change
6. Document significant changes

Focus on:
- Readability and maintainability
- DRY principle
- Single Responsibility Principle
- Clear naming
- Reduced complexity

Do not change functionality or behavior.
